-- ATUALZEI O PRECO_ISTA PARA 5.2 NA TABELA PRODUTOS
UPDATE PRODUTOS
SET PRECO_LISTA = 5.2
WHERE CODIGO = '1040107';

-- ATUALZEI O SABOR PARA 'LARANJA' E A EMBALAGEM PARA 'PET' AO MESMO TEMPO NA TABELA PRODUTOS
UPDATE PRODUTOS
SET SABOR = 'Laranja', EMBALAGEM = 'PET'
WHERE CODIGO = '1040107';

-- ATUALIZEI A PALAVRA MELANCIA DO CODIGO '1040107' PARA LARANJA COM A FUNC REPLACE()
UPDATE PRODUTOS
SET DESCRITOR = REPLACE(DESCRITOR,'Melância','Laranja')
WHERE CODIGO = '1040107';

-- ATUALIZANDO DIVERSOS PRECOS QUE CONTEM O SABOR MARACUJA COM MAIS 10% DE VALOR10% 
UPDATE PRODUTOS
SET PRECO_LISTA = PRECO_LISTA * 1.10
WHERE SABOR = 'Maracuja';

-- ALTERANDO MAIS DE UM VALOR AO MESMO TEMPO
UPDATE TABELA_DE_VENDEDORES_FONTE
SET DE_FERIAS = 0
WHERE MATRICULA IN ('00236','00237');

UPDATE TABELA_DE_VENDEDORES_FONTE
SET DE_FERIAS = 1
WHERE MATRICULA IN ('00235','00238');

--              EXCLUSÃO DE REGISTROS
-- EXCLUSÃO DE UM REGISTROS ATRAVÉS  DA MATRICULA
DELETE FROM PRODUTOS
WHERE CODIGO = '999999';

/* EXCLUSÃO DE REGISTROS DA TABELA PRODUTO P ONDE O RETORNO DA COLUNA  TP.CODIGO_DO_PRODUTO 
DO JOIN ENTRE PRODUTOS P E TABELA_DE_PRODUTOS_FONTE TP SEJA NULO.
*/
DELETE FROM PRODUTOS P
WHERE P.CODIGO IN ( SELECT P.CODIGO
                    FROM PRODUTOS P
                    LEFT  JOIN TABELA_DE_PRODUTOS_FONTE TP
                        ON P.CODIGO = TP.CODIGO_DO_PRODUTO
                    WHERE TP.CODIGO_DO_PRODUTO IS NULL); 

COMMIT;